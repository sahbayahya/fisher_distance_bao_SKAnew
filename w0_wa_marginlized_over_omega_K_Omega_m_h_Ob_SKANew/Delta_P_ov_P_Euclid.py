from math import *from numpy import *from scipy import *import cosmolopy.constants as ccimport cosmolopy.distance as cdimport cosmolopy.perturbation as cpimport matplotlib.pyplot as pltimport matplotlib.ticker as ticimport matplotlib.axis from scipy.integrate import quadfrom scipy import special#===================Read the file==================================(k0_ov_h, k_7, pk) = loadtxt('cosmic_v_k_Euclid.txt', unpack=True)(k_Euclid,  dP_Euclid) = loadtxt('Euclid_dP_z1.dat', unpack=True)#============= inputs ===========================================h = 0.73V_survey = 13.38 * 10**9*(h**-3) # convert V_sur phil  to Mpc^3 h^-3V_survey2= 8155397247.6586103 # output from volume.f90ngal = 1.7378236097892251E-003 # Mpc^-3 h^3#print V_survey ,  V_survey2#==============dp/p=======================k_Euclid = k_Euclid*h # convert units from Mpc^-1 to Mpc^-1 h dlnk=log(k_7) - log(k0_ov_h)factor=(k_7)**3*dlnk/(2.**3 *3.1415926535**2) # Mpc^-3 h^3wkmu=V_survey*(ngal*pk/(1.+ngal*pk))**2 # Mpc^3 h^-3fis_7 = factor * wkmudp_7= (sqrt((fis_7)**-1))#=========plotting =================================#====================================================================fig = plt.figure()ax = fig.add_subplot(111, yscale='log')ax.set_xscale('log')ax.plot(k_7,dp_7, color= 'green', linewidth=2.5, linestyle="-", label ='Euclid')ax.plot(k_Euclid, dP_Euclid, color= 'red',  linewidth=2.5, linestyle="--", label ='Euclid_test')#====================== Labels ==========================ax.set_xlabel(r"$k \ [{\rm Mpc}^{-1} h ]$", fontsize=15)ax.set_ylabel(r"$\delta P/P$ ", fontsize= 17)plt.ylim(0.001, 10**4)plt.xlim(0.0001, 1.0)ax.legend(loc='upper left')plt.savefig('deltaP_ov_p_Euclid.eps')plt.show()print '============== The program executed successfully!=============================='